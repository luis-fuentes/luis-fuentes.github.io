<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Desarrollando con Webpack · Javascript Developer</title><meta name="description" content="Desarrollando con Webpack - Luis Fuentes"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div id="mask" style="display: none;"><img id="mask-image" src="#" style=" "></div><div class="wrap"><header><a href="/" class="logo-link"><img src="/logo-blog.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">ROOT</a></li><li class="nav-list-item"><a href="/archives" target="_self" class="nav-list-link">ARCHIVOS</a></li><li class="nav-list-item"><a href="https://github.com/luis-fuentes" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="https://gitlab.com/u/luisfuentes" target="_blank" class="nav-list-link">GITLAB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Desarrollando con Webpack</h1><div class="post-time">25 de ago. de 2015</div><div class="post-content"><p>En <a href="https://luisfuentes.me/primeros-pasos-webpack/">primeros pasos con Webpack</a> generamos un proyecto básico pero teníamos que ejecutar <em>$ npm run build</em> cada vez que hacíamos un cambio… y adicionalmente refrescar el browser. Con algunos simples cambios intentaremos mejorar nuestro workflow de trabajo.  </p>
<a id="more"></a>
<p>Lo primero es instalar webpack-dev-server</p>
<pre><code>$ npm i webpack-dev-server --save-dev
</code></pre><p>Ademas debemos modificar nuestro package.json para usarlo:</p>
<p><strong>package.json</strong></p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="params">...</span></div><div class="line"><span class="string">"scripts"</span>: &#123;</div><div class="line">  <span class="string">"build"</span>: <span class="string">"webpack"</span>,</div><div class="line">  <span class="string">"start"</span>: <span class="string">"webpack-dev-server --config webpack.development.js --devtool eval-source --progress</span></div><div class="line"> --colors --hot --content-base build"</div><div class="line">&#125;,</div><div class="line"><span class="params">...</span></div></pre></td></tr></table></figure>
<p>  Creamos un nuevo archivo de configuración:</p>
<p><strong>webpack.development.js</strong></p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">var <span class="built_in">path</span> = require(<span class="string">'path'</span>);</div><div class="line"></div><div class="line">var ROOT_PATH = <span class="built_in">path</span>.resolve(__dirname);</div><div class="line"></div><div class="line">module.exports = &#123;</div><div class="line">  entry: [</div><div class="line">    <span class="string">'webpack/hot/dev-server'</span>,</div><div class="line">    <span class="string">'webpack-dev-server/client?http://localhost:8080'</span>,</div><div class="line">    <span class="built_in">path</span>.resolve(ROOT_PATH, <span class="string">'app/main.js'</span>),</div><div class="line">  ],</div><div class="line">  output: &#123;</div><div class="line">    <span class="built_in">path</span>: <span class="built_in">path</span>.resolve(ROOT_PATH, <span class="string">'build'</span>),</div><div class="line">    filename: <span class="string">'bundle.js'</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>Ahora cuento ejecutes <code>$ npm start</code> en tu terminal se ejecutaran los siguientes scripts declarados en package.json</p>
<ol>
<li><strong>webpack-dev-server</strong> - Inicia el server en localhost:8080</li>
<li><strong>–config webpack.development.js</strong> - Apunta a nuestro archivo de configuración. </li>
<li><strong>–devtool eval-source</strong> - Crea la ruta de nuestras urls, para que luego las puedas apuntar con el nombre del archivo.</li>
<li><strong>–progress</strong> - Muestra el progreso de el generador. </li>
<li><strong>–colors</strong> - Agrega colores al terminal. </li>
<li><strong>–hot</strong> - habilita la carga en caliente o hot loading.</li>
<li><strong>–content-base build</strong> - Apunta a build para seguir ocupando index.html(eliminaremos esto luego)</li>
</ol>
<p>Ahora cada vez que ejecutes <code>$ npm start</code> se iniciara el servidor en el puerto 8080 y cada vez que cambies algún archivo estos se generarán automáticamente.</p>
<p>También podemos configurar Webpack para que busque cambios en nuestros archivos css y los actualiza, primero instalamos:</p>
<pre><code>$ npm i css-loader style-loader --save-dev
</code></pre><p>y modificamos nuestro archivo webpack para que busque y cargue todos los archivos terminados en .css.</p>
<p><strong>webpack.development.js</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> ROOT_PATH = path.resolve(__dirname);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  entry: [</div><div class="line">    <span class="string">'webpack-dev-server/client?http://localhost:8080'</span>,</div><div class="line">    <span class="string">'webpack/hot/dev-server'</span>,</div><div class="line">    path.resolve(ROOT_PATH, <span class="string">'app/main'</span>),</div><div class="line">  ],</div><div class="line">  output: &#123;</div><div class="line">    path: path.resolve(ROOT_PATH, <span class="string">'build'</span>),</div><div class="line">    filename: <span class="string">'bundle.js'</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="keyword">module</span>: &#123;</div><div class="line">    loaders: [</div><div class="line">      &#123;</div><div class="line">        test: <span class="regexp">/\.css$/</span>,</div><div class="line">        loaders: [<span class="string">'style'</span>, <span class="string">'css'</span>],</div><div class="line">      &#125;,</div><div class="line">    ],</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>Ahora solo falta un detalle, agregar css a nuestro proyecto…</p>
<p><strong>app/stylesheets/main.css</strong> </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">body</span> &#123;</div><div class="line">  <span class="attribute">background</span>: cornsilk;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>app/main.js</strong></p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span>(<span class="string">'./stylesheets/main.css'</span>);</div><div class="line"><span class="params">...</span></div></pre></td></tr></table></figure>
<p><code>$ npm start</code>y ahora podrás modificar el css y los cambios se cargara automagicamente. Pero esto actualmente no esta funcionando en <code>$ npm run build</code> por lo que tendrías que hacer los mismo cambios en el archivo <em>webpack.config.js</em>… Para ahorrarnos este trabajo podemos unir nuestro archivos de configuración.</p>
<p>Primero instalamos una pequeña utilidad que concatena arrays en lugar de remplazarlos. </p>
<pre><code>$ npm i webpack-merge --save-dev
</code></pre><p>Finalmente modificamos nuestros archivos de configuración:</p>
<p><strong>webpack.config.js</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"><span class="keyword">var</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> TARGET = process.env.TARGET;</div><div class="line"><span class="keyword">var</span> ROOT_PATH = path.resolve(__dirname);</div><div class="line"></div><div class="line"><span class="keyword">var</span> common = &#123;</div><div class="line">  entry: [path.resolve(ROOT_PATH, <span class="string">'app/main'</span>)],</div><div class="line">  output: &#123;</div><div class="line">    path: path.resolve(ROOT_PATH, <span class="string">'build'</span>),</div><div class="line">    filename: <span class="string">'bundle.js'</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="keyword">module</span>: &#123;</div><div class="line">    loaders: [</div><div class="line">      &#123;</div><div class="line">        test: <span class="regexp">/\.css$/</span>,</div><div class="line">        loaders: [<span class="string">'style'</span>, <span class="string">'css'</span>],</div><div class="line">      &#125;,</div><div class="line">    ],</div><div class="line">  &#125;,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(TARGET === <span class="string">'build'</span>) &#123;</div><div class="line">  <span class="built_in">module</span>.exports = common;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(TARGET === <span class="string">'dev'</span>) &#123;</div><div class="line">  <span class="built_in">module</span>.exports = merge(common, &#123;</div><div class="line">    entry: [</div><div class="line">      <span class="string">'webpack-dev-server/client?http://localhost:8080'</span>,</div><div class="line">      <span class="string">'webpack/hot/dev-server'</span></div><div class="line">    ]</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>package.json</strong></p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="params">...</span></div><div class="line"><span class="string">"scripts"</span>: &#123;</div><div class="line">  <span class="string">"build"</span>: <span class="string">"TARGET=build webpack"</span>,</div><div class="line">  <span class="string">"start"</span>: <span class="string">"TARGET=dev webpack-dev-server --devtool eval </span></div><div class="line">--progress --colors --hot --content-base build"</div><div class="line">&#125;,</div><div class="line"><span class="params">...</span></div></pre></td></tr></table></figure>
<p>Finalmente nuestro proyecto funciona en base a el archivo <em>index.html</em> pero cuando comience a crecer, esto puedo generar problemas. Para mejorar esto instalamos:</p>
<pre><code>$ npm i html-webpack-plugin --save-dev
</code></pre><p>Eliminamos nuestro archivo <em>index.html</em> y lo generamos automáticamente en cada build.</p>
<p><strong>webpack.config.js</strong> </p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">var</span> path = <span class="keyword">require</span>(<span class="string">'path'</span>);</div><div class="line"><span class="built_in">var</span> HtmlWebpackPlugin = <span class="keyword">require</span>(<span class="string">'html-webpack-plugin'</span>);</div><div class="line"><span class="built_in">var</span> merge = <span class="keyword">require</span>(<span class="string">'webpack-merge'</span>);</div><div class="line"></div><div class="line"><span class="built_in">var</span> TARGET = process.env.TARGET;</div><div class="line"><span class="built_in">var</span> ROOT_PATH = path.resolve(__dirname);</div><div class="line"></div><div class="line"><span class="built_in">var</span> common = &#123;</div><div class="line">  <span class="params">...</span></div><div class="line">  plugins: <span class="meta">[</span></div><div class="line">    <span class="literal">new</span> HtmlWebpackPlugin(&#123;</div><div class="line">      title: <span class="string">'Webpack app'</span>,</div><div class="line">    &#125;),</div><div class="line">  <span class="meta">]</span>,</div><div class="line">&#125;;</div><div class="line"></div><div class="line">...</div></pre></td></tr></table></figure>
<p>También eliminamos <code>--content-base</code></p>
<p><strong>package.json</strong></p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="string">"scripts"</span>: &#123;</div><div class="line">  <span class="string">"build"</span>: <span class="string">"TARGET=build webpack"</span>,</div><div class="line">  <span class="string">"start"</span>: <span class="comment">"TARGET=dev webpack-dev-server --devtool </span></div><div class="line"><span class="built_in">eval</span>-<span class="keyword">source</span> --progress --colors --hot<span class="comment">"</span></div><div class="line">&#125;,</div><div class="line">...</div></pre></td></tr></table></figure>
<p>Finalmente ejecutamos <code>$ npm run build</code> y nuestro proyecto se generará automáticamente. Debo mencionar que esta no es la única manera de usar Webpack. algunas personas prefieren usar archivos de configuración separados o configurar presets para ocupar en cada proyecto <a href="https://github.com/HenrikJoreteg/hjs-webpack" target="_blank" rel="external">hjs-webpack</a>. </p>
<p>Código fuente en <a href="https://github.com/YotaCL/webpack-boilerplate.git" target="_blank" rel="external">Github</a> </p>
</div></article></div></section><footer><div class="paginator"><a href="/guia-travis-ci/" class="prev">ANT</a><a href="/primeros-pasos-webpack/" class="next">SIG</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'luisfuentes';
var disqus_identifier = 'desarrollando-con-webpack/';
var disqus_title = 'Desarrollando con Webpack';
var disqus_url = 'https://luisfuentes.me/desarrollando-con-webpack/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//luisfuentes.disqus.com/count.js" async></script><div class="copyright"><p>© 2012 - 2016 <a href="https://luisfuentes.me">Luis Fuentes</a>, Valdivia - Chile.</p></div></footer></div><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-64770465-1",'auto');ga('send','pageview');</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>